---
- assert: { that: "ansible_system_vendor == 'HP'" }

- name: Identifying firmware RPM for Power Mangement Controller
  shell: yum search `hp-conrep -s | grep  "System Type" | awk '{print $NF}' | tr A-Z a-z` | grep -i powerpic | awk '{print $1}'
  register: fw_rpm
  changed_when: False
  ignore_errors: True
  check_mode: no

- name: running generic tasks for all firmware things
  include_tasks: firmware_installer.yml
  with_items: "{{ fw_rpm.stdout_lines }}"
  when: fw_rpm.rc == 0
